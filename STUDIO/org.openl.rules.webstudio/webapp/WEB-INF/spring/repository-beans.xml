<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd"
       default-autowire="no">

    <bean id="localWorkspaceManager" class="org.openl.rules.workspace.lw.impl.LocalWorkspaceManagerImpl"
          init-method="init">
        <property name="workspaceHome" value="${user.workspace.home}"/>
        <property name="localWorkspaceFolderFilter" ref="localWorkspaceFolderFilter"/>
        <property name="enableLocks" value="#{'${user.mode}' != 'single'}"/>
    </bean>

    <bean id="designTimeRepository" class="org.openl.rules.workspace.dtr.impl.DesignTimeRepositoryImpl"
          init-method="init" destroy-method="destroy">
        <!--TODO: remove config from there -->
        <property name="config" value="#{systemConfig}"/>
        <property name="environment" value="#{environment}"/>
    </bean>

    <bean id="workspaceManager" class="org.openl.rules.workspace.MultiUserWorkspaceManager">
        <property name="localWorkspaceManager" ref="localWorkspaceManager"/>
        <property name="designTimeRepository" ref="designTimeRepository"/>
    </bean>

    <bean id="productionRepositoryFactoryProxy"
          class="org.openl.rules.webstudio.web.repository.ProductionRepositoryFactoryProxy" destroy-method="destroy">
        <property name="configManagerFactory" ref="productionRepositoryConfigManagerFactory"/>
    </bean>

    <bean id="deploymentManager" class="org.openl.rules.webstudio.web.repository.DeploymentManager">
        <property name="initialProductionRepositoryConfigNames" value="${production-repository-configs}"/>
        <property name="repositoryFactoryProxy" ref="productionRepositoryFactoryProxy"/>
        <property name="designRepository" ref="designTimeRepository"/>
    </bean>

    <bean id="projectDescriptorArtefactResolver"
          class="org.openl.rules.project.resolving.ProjectDescriptorArtefactResolver"/>

    <bean id="designRepositoryComments" class="org.openl.rules.project.abstraction.Comments">
        <constructor-arg name="saveProjectTemplate"
                         value="${design-repository.comment-template.user-message.default.save}"/>
        <constructor-arg name="createProjectTemplate"
                         value="${design-repository.comment-template.user-message.default.create}"/>
        <constructor-arg name="archiveProjectTemplate"
                         value="${design-repository.comment-template.user-message.default.archive}"/>
        <constructor-arg name="restoreProjectTemplate"
                         value="${design-repository.comment-template.user-message.default.restore}"/>
        <constructor-arg name="eraseProjectTemplate"
                         value="${design-repository.comment-template.user-message.default.erase}"/>
        <constructor-arg name="copiedFromTemplate"
                         value="${design-repository.comment-template.user-message.default.copied-from}"/>
        <constructor-arg name="restoredFromTemplate"
                         value="${design-repository.comment-template.user-message.default.restored-from}"/>
    </bean>

    <bean id="deployConfigRepositoryComments" class="org.openl.rules.project.abstraction.Comments">
        <constructor-arg name="saveProjectTemplate"
                         value="${deploy-config-repository.comment-template.user-message.default.save}"/>
        <constructor-arg name="createProjectTemplate"
                         value="${deploy-config-repository.comment-template.user-message.default.create}"/>
        <constructor-arg name="archiveProjectTemplate"
                         value="${deploy-config-repository.comment-template.user-message.default.archive}"/>
        <constructor-arg name="restoreProjectTemplate"
                         value="${deploy-config-repository.comment-template.user-message.default.restore}"/>
        <constructor-arg name="eraseProjectTemplate"
                         value="${deploy-config-repository.comment-template.user-message.default.erase}"/>
        <constructor-arg name="copiedFromTemplate"
                         value="${deploy-config-repository.comment-template.user-message.default.copied-from}"/>
        <constructor-arg name="restoredFromTemplate"
                         value="${deploy-config-repository.comment-template.user-message.default.restored-from}"/>
    </bean>
</beans>
